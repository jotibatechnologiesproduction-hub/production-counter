<!-- UPDATED DASHBOARD WITH TIME-BASED PIE CHART & MANUAL HOURLY ENTRY -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Production Dashboard</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body { font-family: Arial, sans-serif; background:#f4f4f4; }
    .grid { display:grid; grid-template-columns: repeat(3, 1fr); gap:15px; }
    .card { background:#fff; border:1px solid #ccc; padding:10px; }
    .title { background:#6cab43; color:#fff; padding:5px; text-align:center; font-weight:bold; }
    .row { display:flex; justify-content:space-between; margin:4px 0; }
    input { width:70px; }
  </style>
</head>
<body>
<h2>Automatic Production Counter â€“ Manual Hourly Mode</h2>
<div class="grid" id="dashboard"></div>

<script>
const machines = [
 {name:'CNC 01', pph:200}, {name:'CNC 02', pph:200}, {name:'CNC 03', pph:250},
 {name:'CNC 04', pph:200}, {name:'CNC 05', pph:200},
 {name:'CG 01', pph:360}, {name:'CG 02', pph:360}, {name:'CG 03', pph:360}, {name:'CG 04', pph:360}
];

const hours = new Date().getHours(); // current hour

machines.forEach((m, i) => {
  const target = m.pph * hours;
  const id = 'm'+i;
  document.getElementById('dashboard').innerHTML += `
  <div class="card">
    <div class="title">${m.name}</div>
    <div class="row">Targeted: <span id="t${id}">${target}</span></div>
    <div class="row">Actual: <input type="number" id="a${id}" value="0" onchange="update(${i})"></div>
    <canvas id="c${id}" height="120"></canvas>
  </div>`;
});

const charts = [];
function update(i){
  const h = hours;
  const m = machines[i];
  const target = m.pph * h;
  const actual = +document.getElementById('a'+ 'm'+i).value;
  const bal = Math.max(target-actual,0);

  if(charts[i]) charts[i].destroy();
  charts[i] = new Chart(document.getElementById('c'+'m'+i),{
    type:'pie',
    data:{ labels:['Produced','Remaining'], datasets:[{ data:[actual, bal], backgroundColor:['#4caf50','#ff9800'] }]},
    options:{ plugins:{ legend:{display:false} } }
  });
}
</script>
</body>
</html>